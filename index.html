<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Painel de Cores Seguro</title>
<style>
    body { font-family: Arial, sans-serif; background: #f3f3f3; display: flex; justify-content: center; align-items: center; height: 100vh; margin:0; }
    .card { background: white; padding:25px; border-radius:12px; box-shadow:0 4px 12px rgba(0,0,0,0.15); width:350px; text-align:center; }
    .input-row { display:flex; justify-content:space-between; margin-bottom:20px; }
    input { width:45%; padding:10px; font-size:16px; border-radius:8px; border:1px solid #aaa; }
    button { width:100%; padding:10px; border:none; border-radius:8px; background:#0077ff; font-size:17px; color:white; cursor:pointer; margin-bottom:10px; }
    .secondary-button { background: #28a745; }
    .danger-button { background: #dc3545; }
    #resultadoCor { width:120px; height:120px; margin:0 auto; border-radius:10px; border:2px solid #111; }
    .hidden { display:none; }
</style>
<!-- Firebase App (Core) -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>

<!-- Tela de Login -->
<div class="card" id="loginCard">
    <h2>Login</h2>
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="Senha" required>
    <button onclick="login()">Entrar</button>
</div>

<!-- Tela de Registro Admin (oculto até login admin) -->
<div class="card hidden" id="registerCard">
    <h2>Registrar Usuário (Admin)</h2>
    <input type="email" id="newEmail" placeholder="Email do Usuário" required>
    <input type="password" id="newPassword" placeholder="Senha do Usuário" required>
    <button onclick="register()">Registrar</button>
    <button class="danger-button" onclick="logout()">Voltar</button>
</div>

<!-- Painel de Cores -->
<div class="card hidden" id="panelCard">
    <h2>Painel de Cores</h2>
    <div class="input-row">
        <input type="number" id="linha" placeholder="1°Núm (0 a 14)">
        <input type="number" id="coluna" placeholder="2°Núm (0 a 14)">
    </div>
    <button onclick="mostrarCor()">Resultado</button>
    <div id="resultadoCor"></div>
    <button class="secondary-button" onclick="showRegisterCard()">Registrar Usuário</button>
    <button class="danger-button" onclick="logout()">Logout</button>
</div>

<script>
// --- Config Firebase ---
const firebaseConfig = {
  apiKey: "AIzaSyD4Uhb0M5tXzvREMt5XIFksB-L3rzkNGiY",
  authDomain: "painel-cores.firebaseapp.com",
  projectId: "painel-cores",
  storageBucket: "painel-cores.firebasestorage.app",
  messagingSenderId: "553983470032",
  appId: "1:553983470032:web:ff95d4cf91ae7a3416b1d5"
};
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

// --- Lista de cores ---
const lista = [
    "vvpvvvpppvpvvvv","pppppvppvvpvpvp","vvpvvpppppppvvv","vvvpvvpvvvppvvp",
    "ppvvvpvpvvvppvp","pvpvpvvvpvpppvv","vvvvpvpppvvvpvv","pvpvvvppvvvpppv",
    "vvpvpvvvpvvvvvv","pvvvppvpvvvvvvv","vpppvvpvvpvppvp","vvvvpvvppvpppvp",
    "vpvpvppvpvvvppv","vvpvvpppppvvvpp","vvpppvppppvpppp"
];

// --- Funções de exibição ---
function showLogin() { document.getElementById("loginCard").classList.remove("hidden"); document.getElementById("panelCard").classList.add("hidden"); document.getElementById("registerCard").classList.add("hidden"); }
function showPanel() { document.getElementById("loginCard").classList.add("hidden"); document.getElementById("panelCard").classList.remove("hidden"); }
function showRegisterCard() { document.getElementById("registerCard").classList.remove("hidden"); }

// --- Login ---
async function login() {
    const email = document.getElementById("email").value.trim();
    const password = document.getElementById("password").value;
    if(!email || !password){ alert("Preencha todos os campos!"); return; }
    try{
        const userCredential = await auth.signInWithEmailAndPassword(email,password);
        showPanel();
    }catch(e){ alert("Email ou senha incorretos!"); }
}

// --- Logout ---
function logout(){
    auth.signOut();
    showLogin();
}

// --- Registrar novo usuário (só admin) ---
async function register(){
    const newEmail = document.getElementById("newEmail").value.trim();
    const newPassword = document.getElementById("newPassword").value;
    if(!newEmail || !newPassword){ alert("Preencha todos os campos!"); return; }

    // Verifica se quem está logado é admin
    const currentUser = auth.currentUser;
    if(!currentUser){ alert("Você precisa estar logado como admin!"); return; }

    if(currentUser.email !== "admin@painel.com"){ alert("Apenas admin pode criar usuários!"); return; }

    try{
        await auth.createUserWithEmailAndPassword(newEmail,newPassword);
        alert("Usuário registrado com sucesso!");
        document.getElementById("newEmail").value="";
        document.getElementById("newPassword").value="";
    }catch(e){ alert("Erro: "+e.message); }
}

// --- Painel de cores ---
function mostrarCor(){
    let linha = parseInt(document.getElementById("linha").value);
    let coluna = parseInt(document.getElementById("coluna").value);
    if(isNaN(linha)||isNaN(coluna)||linha<0||linha>14||coluna<0||coluna>14){
        alert("Números entre 0 e 14."); return;
    }
    let letra = lista[linha][coluna];
    let cor = letra==="v"?"red":"black";
    document.getElementById("resultadoCor").style.background = cor;
}

// --- Mantém usuário logado mesmo recarregando ---
auth.onAuthStateChanged(user => { if(user) showPanel(); else showLogin(); });
</script>

</body>
</html>
